{%- assign emptyarray = "" | split: "," -%}
{%- assign data = site.data[include.data] | default: site[include.data] | default: emptyarray -%}
{%- assign filters = include.filters | split: "," -%}

{%- for filter in filters -%}
  {%- assign entry = filter | split: ":" -%}
  {%- assign key = entry[0] | strip -%}
  {%- assign value = entry[1] | strip | default: nil -%}
  {%- if value contains "~" -%}
    {%- assign value = value | remove: "~" -%}
    {%- assign data = data | where_exp: "d", "d[key] contains value" -%}
  {%- else -%}
    {%- assign data = data | where_exp: "d", "d[key] == value" -%}
  {%- endif -%}
{%- endfor -%}

{%- for d in data -%}
  <div>
    {%- if d.text -%}
      <p>{{ d.text }}</p>
    {%- endif -%}

    {%- if d.image -%}
      <img src="{{ d.image }}" alt="{{ d.text | default: 'Image' }}">
    {%- endif -%}
  </div>
{%- endfor -%}
